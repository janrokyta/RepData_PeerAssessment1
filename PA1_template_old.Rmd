---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---
setwd(Z:/R/project/RepData_PeerAssessment1)

## Loading and preprocessing the data
  
```r{}  
activity <- read.csv("activity.csv")
sumstep <- aggregate(activity$steps, by=list(activity$date), FUN=sum)
```

## What is mean total number of steps taken per day?

```r{}
hist(sumstep$x)
mean(sumstep$x, na.rm = TRUE)
median(sumstep$x, na.rm = TRUE)
```

## What is the average daily activity pattern?

```r{}
activity2 <- na.omit(activity)
sumint <- aggregate(activity2$steps, by=list(activity2$interval), FUN=sum)
plot(sumint$Group.1, sumint$x, type="l", xlab= "Intervals", ylab= "Number of steps")
subset(sumint, x == max(sumint$x), select=c(Group.1, x))
```

## Imputing missing values

```r{}
summean <- aggregate(activity2$steps, by=list(activity2$interval), FUN=mean)
activity_mean <- merge(activity, summean, by.x = "interval", by.y = "Group.1")
activity_mean$steps[is.na(activity_mean$steps)] <- activity_mean$x[is.na(activity_mean$steps)]

activity_no_na <- setNames(data.frame(activity_mean$steps, activity_mean$date, activity_mean$interval), c("steps","date","interval"))
sumstep_no_na <- aggregate(activity_no_na$steps, by=list(activity$date), FUN=sum)
hist(sumstep_no_na$x)
mean(sumstep_no_na$x, na.rm = TRUE)
median(sumstep_no_na$x, na.rm = TRUE)
```

## Are there differences in activity patterns between weekdays and weekends?

```r{}
activity_no_na$date <- as.Date(activity_no_na$date)

Sys.setlocale("LC_TIME", "English")
activity_no_na$weekday <- weekdays(activity_no_na$date)

wdays <- c('Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday')

activity_no_na$day <- factor((weekdays(activity_no_na$date) %in% wdays), 
         levels=c(FALSE, TRUE), labels=c('weekend', 'weekday')
     
summean2 <- aggregate(activity_no_na$steps, by=list(activity_no_na$day, activity_no_na$interval), FUN=mean)
```

```r{}
library(data.table)
require(ggplot2)
```

```r{}
ggplot(summean2) +
geom_line(aes(x=Group.2, y=x)) +
facet_wrap(~Group.1, nrow=2) +
xlab("Interval") +
ylab("Number of steps") 
```
